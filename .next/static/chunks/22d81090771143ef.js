(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,85775,e=>{"use strict";e.s(["default",()=>n]);var r=e.i(43476),s=e.i(71645),a=e.i(22016),t=e.i(42252),o=e.i(16973),l=e.i(55613),i=e.i(87590);function n(){let[e,n]=(0,s.useState)([]),[d,c]=(0,s.useState)(!0),[p,x]=(0,s.useState)(""),[m,g]=(0,s.useState)(""),[h,u]=(0,s.useState)("all"),[f,y]=(0,s.useState)(1),[b,v]=(0,s.useState)(1),[j,N]=(0,s.useState)(0),w=(0,s.useCallback)(async()=>{try{c(!0),x(""),console.log("ðŸ”„ Fetching brokers with statusFilter:",h);let e="approved"===h||"pending"!==h&&void 0,r=await o.brokerAPI.getBrokers(f,10,e);console.log("ðŸ“Š API Response:",r),console.log("ðŸ“Š Brokers data:",r.data.brokers),r.data.brokers&&r.data.brokers.forEach((e,r)=>{console.log("ðŸ“Š Broker ".concat(r+1,":"),{_id:e._id,name:e.name,approvedByAdmin:e.approvedByAdmin,type:typeof e.approvedByAdmin})}),n(r.data.brokers||[]),v(r.data.pagination.totalPages||1),N(r.data.pagination.totalBrokers||0)}catch(e){x(e instanceof Error?e.message:"Failed to fetch brokers")}finally{c(!1)}},[f,h]),k=async e=>{try{x(""),console.log("ðŸŸ¢ Approving broker with ID:",e);let r=await o.brokerAPI.approveBroker(e);console.log("ðŸŸ¢ Approve API response:",r),n(r=>r.map(r=>r._id===e?{...r,approvedByAdmin:"approved"}:r)),await w()}catch(e){console.error("ðŸŸ¢ Approve error:",e),x(e instanceof Error?e.message:"Failed to approve broker")}},A=async e=>{try{x(""),console.log("ðŸ”´ Rejecting broker with ID:",e);let r=await o.brokerAPI.rejectBroker(e);console.log("ðŸ”´ Reject API response:",r),n(r=>r.map(r=>r._id===e?{...r,approvedByAdmin:"rejected"}:r)),await w()}catch(e){console.error("ðŸ”´ Reject error:",e),x(e instanceof Error?e.message:"Failed to reject broker")}},C=e.filter(e=>(e.name||"").toLowerCase().includes(m.toLowerCase())||(e.email||"").toLowerCase().includes(m.toLowerCase())||(e.phone||"").includes(m)||e.firmName.toLowerCase().includes(m.toLowerCase()));(0,s.useEffect)(()=>{w()},[w]),(0,s.useEffect)(()=>{y(1)},[h]);let B=()=>(0,r.jsxs)("tr",{className:"bg-white border-b border-gray-200",children:[(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)("div",{className:"h-10 w-10 bg-gray-200 rounded-full animate-pulse"})}),(0,r.jsxs)("div",{className:"ml-4 space-y-2",children:[(0,r.jsx)("div",{className:"h-4 bg-gray-200 rounded animate-pulse w-28"}),(0,r.jsx)("div",{className:"h-3 bg-gray-200 rounded animate-pulse w-36"})]})]})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("div",{className:"h-4 bg-gray-200 rounded animate-pulse w-24"})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("div",{className:"h-4 bg-gray-200 rounded animate-pulse w-40"})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("div",{className:"h-4 bg-gray-200 rounded animate-pulse w-24"})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("div",{className:"h-6 bg-gray-200 rounded-full animate-pulse w-20"})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("div",{className:"h-4 w-4 bg-gray-200 rounded animate-pulse"}),(0,r.jsx)("div",{className:"h-4 w-4 bg-gray-200 rounded animate-pulse"})]})})]});return(0,r.jsx)(t.default,{children:(0,r.jsxs)("div",{className:" space-y-6",children:[(0,r.jsx)("div",{className:"mb-6",children:(0,r.jsx)("div",{className:"flex justify-between items-center",children:(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Brokers"}),(0,r.jsx)("p",{className:"text-gray-600 mt-1",children:"View and manage all registered brokers"})]})})}),(0,r.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between space-y-4 lg:space-y-0",children:[(0,r.jsx)("div",{className:"flex-1 max-w-md",children:(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,r.jsx)("svg",{className:"h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),(0,r.jsx)("input",{type:"text",placeholder:"Search by Firm Name, Contact, Region",value:m,onChange:e=>g(e.target.value),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-1 focus:ring-primary focus:border-primary"})]})}),(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Status:"}),(0,r.jsx)("div",{className:"w-48",children:(0,r.jsx)(l.default,{options:[{value:"all",label:"All Brokers"},{value:"pending",label:"Pending Approval"},{value:"approved",label:"Approved"}],value:{value:h,label:"all"===h?"All Brokers":"pending"===h?"Pending Approval":"Approved"},onChange:e=>u((null==e?void 0:e.value)||"all"),placeholder:"Select Status",isSearchable:!1,isClearable:!1,styles:{control:(e,r)=>({...e,minHeight:"40px",fontSize:"14px",border:"1px solid #d1d5db",borderRadius:"8px",boxShadow:r.isFocused?"0 0 0 2px rgba(59, 130, 246, 0.5)":"none","&:hover":{border:"1px solid #9ca3af"}}),option:(e,r)=>({...e,backgroundColor:r.isSelected?"#3b82f6":r.isFocused?"#f3f4f6":"white",color:r.isSelected?"white":"#374151",fontSize:"14px",padding:"8px 12px"}),singleValue:e=>({...e,color:"#374151",fontSize:"14px"}),placeholder:e=>({...e,color:"#9ca3af",fontSize:"14px"})}})})]})]}),p&&(0,r.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:p}),(0,r.jsx)("div",{className:"shadow-sm rounded-lg overflow-hidden",children:(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-gray-300",children:[(0,r.jsx)("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"NAME"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"CONTACT"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"REGION"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ACTION"})]})}),(0,r.jsx)("tbody",{className:"bg-white divide-y divide-gray-300",children:d?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(B,{}),(0,r.jsx)(B,{}),(0,r.jsx)(B,{}),(0,r.jsx)(B,{}),(0,r.jsx)(B,{})]}):0===C.length?(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:4,className:"px-6 py-4 text-center text-gray-500",children:"No brokers found"})}):C.map(e=>(0,r.jsxs)("tr",{className:"bg-white hover:bg-gray-50 border-b border-gray-200 transition-colors duration-200",children:[(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)(a.default,{href:"/brokers/".concat(e._id),className:"cursor-pointer",children:(0,r.jsx)("img",{className:"h-10 w-10 rounded-full object-cover hover:opacity-80 transition-opacity duration-200",src:(e=>{if(console.log("ðŸ–¼ï¸ getBrokerImageUrl called with:",e),!e)return console.log("ðŸ–¼ï¸ No broker image, using fallback"),"https://www.w3schools.com/howto/img_avatar.png";if(e.includes("broker-adda-be.algofolks.com")||e.includes("https://")||e.includes("http://")&&!e.includes("localhost")){let r="/api/image-proxy?url=".concat(encodeURIComponent(e));return console.log("ðŸ–¼ï¸ Using proxy URL:",r),r}return console.log("ðŸ–¼ï¸ Using direct URL:",e),e})(e.brokerImage),alt:e.name||"Broker",onError:r=>{console.log("ðŸ–¼ï¸ Image failed to load:",e.brokerImage),r.currentTarget.src="https://www.w3schools.com/howto/img_avatar.png"}})})}),(0,r.jsxs)("div",{className:"ml-4",children:[(0,r.jsx)(a.default,{href:"/brokers/".concat(e._id),className:"text-sm font-medium text-gray-900 hover:text-primary transition-colors duration-200 cursor-pointer",children:e.name||"N/A"}),(0,r.jsx)("div",{className:"text-sm text-gray-500",children:e.firmName||"N/A"})]})]})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsxs)("div",{className:"flex items-center text-gray-900",children:[e.email||"N/A",e.email&&(0,r.jsx)("svg",{className:"w-4 h-4 text-green-500 ml-2",fill:"currentColor",viewBox:"0 0 20 20",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})]}),(0,r.jsxs)("div",{className:"flex items-center text-gray-500 text-xs mt-1",children:[e.phone||"N/A",e.phone&&(0,r.jsx)("svg",{className:"w-3 h-3 text-green-500 ml-2",fill:"currentColor",viewBox:"0 0 20 20",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})]})]})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)("div",{children:e.region&&e.region.length>0?e.region[0].name:"N/A"}),(0,r.jsx)("div",{className:"text-gray-500 text-xs mt-1",children:e.region&&e.region.length>0?"".concat(e.region[0].city,", ").concat(e.region[0].state):"No Region Assigned"})]})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,r.jsx)("div",{className:"flex space-x-2",children:(console.log("ðŸ” Broker ID:",e._id,"approvedByAdmin:",e.approvedByAdmin,"Type:",typeof e.approvedByAdmin),"approved"===e.approvedByAdmin)?(0,r.jsxs)("span",{className:"inline-flex items-center px-3 py-1 text-xs font-medium rounded-full bg-green-100 text-green-800 border border-green-200",children:[(0,r.jsx)("div",{className:"w-2 h-2 rounded-full mr-2 bg-green-600"}),"Approved"]}):"rejected"===e.approvedByAdmin?(0,r.jsxs)("span",{className:"inline-flex items-center px-3 py-1 text-xs font-medium rounded-full bg-red-100 text-red-800 border border-red-200",children:[(0,r.jsx)("div",{className:"w-2 h-2 rounded-full mr-2 bg-red-600"}),"Rejected"]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("button",{onClick:()=>k(e._id),className:"inline-flex items-center px-4 py-2 text-xs font-medium rounded text-white bg-primary hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary transition-colors cursor-pointer",children:"Approve"}),(0,r.jsx)("button",{onClick:()=>A(e._id),className:"inline-flex items-center px-4 py-2 text-xs font-medium rounded text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 transition-colors cursor-pointer",children:"Reject"})]})})})]},e._id))})]})})}),j>0&&(0,r.jsxs)("div",{className:"flex items-center justify-between px-6 py-3",children:[(0,r.jsx)("div",{className:"flex items-center text-sm text-gray-700",children:(0,r.jsxs)("span",{children:["Showing ",(f-1)*10+1," to ",Math.min(10*f,j)," of ",j," results"]})}),(0,r.jsx)(i.default,{pageCount:b,pageRangeDisplayed:3,marginPagesDisplayed:1,onPageChange:e=>{let{selected:r}=e;return y(r+1)},forcePage:f-1,previousLabel:"Previous",nextLabel:"Next",breakLabel:"...",containerClassName:"flex items-center space-x-1",pageClassName:"px-3 py-2 text-sm font-medium rounded-md cursor-pointer text-gray-500 bg-white border border-gray-300 hover:bg-gray-50 transition-colors",activeClassName:"bg-primary text-white border-primary",previousClassName:"px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed cursor-pointer transition-colors",nextClassName:"px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed cursor-pointer transition-colors",breakClassName:"px-3 py-2 text-sm font-medium text-gray-500",disabledClassName:"opacity-50 cursor-not-allowed"})]})]})})}}]);