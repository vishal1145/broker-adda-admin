(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,36557,(e,r,t)=>{r.exports=e.r(84059)},88731,e=>{"use strict";e.s(["default",()=>o]);var r=e.i(32023),t=e.i(36557);function o(e){let{children:o}=e,s=(0,t.usePathname)();return(0,r.jsx)("div",{className:"h-screen flex overflow-hidden bg-white",children:(0,r.jsxs)("div",{className:"flex flex-col w-full overflow-hidden",children:[(0,r.jsxs)("div",{className:"relative z-10 flex-shrink-0 flex h-16 bg-white shadow-sm border-b border-gray-200",children:[(0,r.jsxs)("div",{className:"flex items-center px-8 space-x-8",children:[(0,r.jsx)("a",{href:"/brokers",className:"text-sm font-medium transition-colors border-b-2 ".concat("/brokers"===s?"text-primary border-primary":"text-gray-700 hover:text-primary border-transparent hover:border-primary"),children:"Brokers"}),(0,r.jsx)("a",{href:"/regions",className:"text-sm font-medium transition-colors border-b-2 ".concat("/regions"===s?"text-primary border-primary":"text-gray-700 hover:text-primary border-transparent hover:border-primary"),children:"Regions"})]}),(0,r.jsx)("div",{className:"flex-1 px-10 flex justify-end items-center",children:(0,r.jsx)("div",{className:"flex items-center space-x-4",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsxs)("div",{className:"ml-3",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-900",children:"Rohit Tyagi"}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:"Admin"})]}),(0,r.jsx)("button",{className:"ml-2 text-gray-400 hover:text-gray-500",children:(0,r.jsx)("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})})})]}),(0,r.jsx)("main",{className:"flex-1 relative overflow-y-auto focus:outline-none",children:(0,r.jsx)("div",{className:"py-6",children:(0,r.jsx)("div",{className:"max-w-7xl mx-auto   ",children:o})})})]})})}},23036,e=>{"use strict";e.s(["brokerAPI",()=>t,"regionAPI",()=>o]);let r="https://broker-adda-be.algofolks.com/api",t={getBrokers:async(e,t,o)=>{let s=localStorage.getItem("adminToken");if(!s)throw Error("No authentication token found");let a=new URLSearchParams({page:e.toString(),limit:t.toString(),...void 0!==o&&{approvedByAdmin:o.toString()}}),n=await fetch("".concat(r,"/brokers?").concat(a),{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(s)}});if(!n.ok)throw Error("Failed to fetch brokers");return n.json()},approveBroker:async e=>{console.log("🟢 brokerAPI.approveBroker called with ID:",e);let t=localStorage.getItem("adminToken");if(console.log("🟢 Token found:",t?"Yes":"No"),!t)throw Error("No authentication token found");let o="".concat(r,"/brokers/").concat(e,"/approve");console.log("🟢 Making API call to:",o),console.log("🟢 API_BASE_URL:",r);let s=await fetch(o,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({})});if(console.log("🟢 Response status:",s.status),console.log("🟢 Response ok:",s.ok),!s.ok)throw console.error("🔴 API Error:",await s.text()),Error("Failed to approve broker");let a=await s.json();return console.log("🟢 API Response:",a),console.log("🟢 API Response data:",a.data),console.log("🟢 Updated broker:",a.data),a},rejectBroker:async e=>{console.log("🔴 brokerAPI.rejectBroker called with ID:",e);let t=localStorage.getItem("adminToken");if(console.log("🔴 Token found:",t?"Yes":"No"),!t)throw Error("No authentication token found");let o="".concat(r,"/brokers/").concat(e,"/reject");console.log("🔴 Making API call to:",o),console.log("🔴 API_BASE_URL:",r);let s=await fetch(o,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({})});if(console.log("🔴 Response status:",s.status),console.log("🔴 Response ok:",s.ok),!s.ok)throw console.error("🔴 API Error:",await s.text()),Error("Failed to reject broker");let a=await s.json();return console.log("🔴 API Response:",a),console.log("🔴 API Response data:",a.data),console.log("🔴 Updated broker:",a.data),a}},o={getRegions:async()=>{console.log("🟢 regionAPI.getRegions called");let e=localStorage.getItem("adminToken");if(console.log("🟢 Token found:",e?"Yes":"No"),!e)throw Error("No authentication token found");let t="".concat(r,"/regions");console.log("🟢 Making API call to:",t);let o=await fetch(t,{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}});if(console.log("🟢 Response status:",o.status),console.log("🟢 Response ok:",o.ok),!o.ok)throw console.error("🔴 API Error:",await o.text()),Error("Failed to fetch regions");let s=await o.json();return console.log("🟢 API Response:",s),s},createRegion:async(e,t)=>{console.log("🔵 regionAPI.createRegion called with:",{name:e,description:t});let o=localStorage.getItem("adminToken");if(console.log("🔵 Token found:",o?"Yes":"No"),!o)throw Error("No authentication token found");let s="".concat(r,"/regions"),a={name:e,description:t};console.log("🔵 Making API call to:",s),console.log("🔵 Request body:",a),console.log("🔵 Headers:",{"Content-Type":"application/json",Authorization:"Bearer ".concat(o)});let n=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(o)},body:JSON.stringify(a)});if(console.log("🔵 Response status:",n.status),console.log("🔵 Response ok:",n.ok),!n.ok)throw console.error("🔴 API Error:",await n.text()),Error("Failed to create region");let i=await n.json();return console.log("🔵 API Response:",i),i},getBrokersByRegion:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,s=localStorage.getItem("adminToken");if(!s)throw Error("No authentication token found");let a=new URLSearchParams({page:t.toString(),limit:o.toString(),regionId:e}),n=await fetch("".concat(r,"/brokers/region/").concat(e,"?").concat(a),{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(s)}});if(!n.ok)throw Error("Failed to fetch brokers by region");return n.json()}}},85693,e=>{"use strict";e.s(["default",()=>a]);var r=e.i(32023),t=e.i(82701),o=e.i(88731),s=e.i(23036);function a(){let[e,a]=(0,t.useState)([]),[n,i]=(0,t.useState)([]),[l,c]=(0,t.useState)(null),[d,x]=(0,t.useState)(!0),[g,m]=(0,t.useState)(!1),[p,h]=(0,t.useState)(""),[y,u]=(0,t.useState)(!1),[f,b]=(0,t.useState)({name:"",description:""}),j=async()=>{try{x(!0),h("");let e=await s.regionAPI.getRegions();console.log("Regions API Response:",e),e&&e.data&&e.data.regions&&Array.isArray(e.data.regions)?a(e.data.regions):Array.isArray(e)?a(e):e.data&&Array.isArray(e.data)?a(e.data):e.regions&&Array.isArray(e.regions)?a(e.regions):(console.warn("Unexpected API response structure:",e),a([]))}catch(e){console.error("Error fetching regions:",e),h(e instanceof Error?e.message:"Failed to fetch regions"),a([])}finally{x(!1)}},N=async e=>{try{m(!0),h("");let r=await s.regionAPI.getBrokersByRegion(e);console.log("Brokers by region API Response:",r),r&&r.data&&r.data.brokers&&Array.isArray(r.data.brokers)?i(r.data.brokers):Array.isArray(r)?i(r):r.data&&Array.isArray(r.data)?i(r.data):r.brokers&&Array.isArray(r.brokers)?i(r.brokers):(console.warn("Unexpected brokers API response structure:",r),i([]))}catch(e){console.error("Error fetching brokers by region:",e),h(e instanceof Error?e.message:"Failed to fetch brokers"),i([])}finally{m(!1)}},w=async e=>{e.preventDefault(),console.log("Form submitted with data:",f);try{h(""),console.log("Calling regionAPI.createRegion...");let e=await s.regionAPI.createRegion(f.name,f.description);console.log("Create region API Response:",e),b({name:"",description:""}),u(!1),console.log("Refreshing regions list..."),j()}catch(e){console.error("Error creating region:",e),h(e instanceof Error?e.message:"Failed to create region")}},k=async e=>{try{h(""),await s.brokerAPI.approveBroker(e),l&&N(l._id)}catch(e){h(e instanceof Error?e.message:"Failed to approve broker")}},v=async e=>{try{h("");let r=await s.brokerAPI.rejectBroker(e);console.log("🔴 Reject API response:",r),i(r=>r.map(r=>r._id===e?{...r,status:"inactive",approvedByAdmin:!1}:r)),l&&N(l._id)}catch(e){h(e instanceof Error?e.message:"Failed to reject broker")}};return(0,t.useEffect)(()=>{console.log("🚀 RegionsPage component mounted"),console.log("🚀 Checking for admin token...");let e=localStorage.getItem("adminToken");console.log("🚀 Token exists:",e?"Yes":"No"),e&&console.log("🚀 Token preview:",e.substring(0,20)+"..."),j()},[]),(0,r.jsx)(o.default,{children:(0,r.jsxs)("div",{className:" space-y-6 ",children:[(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Region Management"}),(0,r.jsx)("p",{className:"text-gray-600 mt-1",children:"Manage regions and view brokers by region"})]}),(0,r.jsx)("div",{className:"flex justify-between items-center",children:(0,r.jsx)("button",{onClick:()=>u(!y),className:"bg-primary text-white px-4 py-2 rounded-lg hover:bg-primary/90 transition-colors",children:y?"Cancel":"Add New Region"})}),y&&(0,r.jsxs)("div",{className:" p-6 rounded-lg shadow-sm border border-gray-300",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Add New Region"}),(0,r.jsxs)("form",{onSubmit:w,className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Region Name"}),(0,r.jsx)("input",{type:"text",value:f.name,onChange:e=>b({...f,name:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary",placeholder:"Enter region name",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),(0,r.jsx)("textarea",{value:f.description,onChange:e=>b({...f,description:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary",placeholder:"Enter region description",rows:3,required:!0})]}),(0,r.jsxs)("div",{className:"flex space-x-3",children:[(0,r.jsx)("button",{type:"submit",className:"bg-primary text-white px-4 py-2 rounded-lg hover:bg-primary/90 transition-colors",children:"Create Region"}),(0,r.jsx)("button",{type:"button",onClick:()=>u(!1),className:"bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition-colors",children:"Cancel"})]})]})]}),p&&(0,r.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:p}),(0,r.jsx)("div",{className:" shadow-sm rounded-lg border border-gray-300 overflow-hidden",children:(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-gray-300",children:[(0,r.jsx)("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"REGION NAME"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"DESCRIPTION"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"CREATED DATE"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"UPDATED DATE"})]})}),(0,r.jsx)("tbody",{className:"bg-white divide-y divide-gray-300",children:d?(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:4,className:"px-6 py-4 text-center",children:(0,r.jsxs)("div",{className:"flex items-center justify-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-primary"}),(0,r.jsx)("span",{className:"ml-2 text-gray-600",children:"Loading regions..."})]})})}):Array.isArray(e)&&0!==e.length?e.map((e,t)=>(0,r.jsxs)("tr",{className:"".concat(t%2==0?"bg-white":"bg-gray-50"," hover:bg-gray-100 cursor-pointer border-b border-gray-300 ").concat((null==l?void 0:l._id)===e._id?"bg-primary/5":""),onClick:()=>{c(e),N(e._id)},children:[(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.name})}),(0,r.jsx)("td",{className:"px-6 py-4",children:(0,r.jsx)("div",{className:"text-sm text-gray-900 max-w-xs truncate",children:e.description})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("div",{className:"text-sm text-gray-900",children:new Date(e.createdAt).toLocaleDateString()})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("div",{className:"text-sm text-gray-900",children:new Date(e.updatedAt).toLocaleDateString()})})]},e._id)):(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:4,className:"px-6 py-4 text-center text-gray-500",children:"No regions found. Create your first region above."})})})]})})}),l&&(0,r.jsxs)("div",{className:"mt-8",children:[(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsxs)("h2",{className:"text-xl font-semibold text-gray-900",children:["Brokers in ",l.name]}),(0,r.jsx)("p",{className:"text-gray-600",children:l.description})]}),(0,r.jsx)("div",{className:"bg-white shadow-sm rounded-lg border border-gray-200 overflow-hidden",children:(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,r.jsx)("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"NAME"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"COMPANY NAME"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"CONTACT"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"STATUS"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ACTION"})]})}),(0,r.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:g?(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:5,className:"px-6 py-4 text-center",children:(0,r.jsxs)("div",{className:"flex items-center justify-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-primary"}),(0,r.jsx)("span",{className:"ml-2 text-gray-600",children:"Loading brokers..."})]})})}):Array.isArray(n)&&0!==n.length?n.map((e,t)=>(0,r.jsxs)("tr",{className:"".concat(t%2==0?"bg-white":"bg-gray-50"," hover:bg-gray-100 border-b border-gray-200"),children:[(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)("div",{className:"h-10 w-10 rounded-full bg-orange-500 flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-sm font-medium text-white",children:(e.name||e.firmName||"B").split(" ").map(e=>e[0]).join("").toUpperCase()})})}),(0,r.jsxs)("div",{className:"ml-4",children:[(0,r.jsxs)("div",{className:"text-sm font-medium text-gray-900",children:[e.name||"N/A"," (",t+1,")"]}),(0,r.jsx)("div",{className:"text-sm text-gray-500",children:e.email||"N/A"})]})]})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.firmName||"N/A"}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.phone||"N/A"}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsxs)("span",{className:"inline-flex items-center px-3 py-1 text-xs font-medium rounded-full border ".concat(e.approvedByAdmin?"bg-green-100 text-green-800 border-green-200":"bg-yellow-100 text-yellow-800 border-yellow-200"),children:[(0,r.jsx)("div",{className:"w-2 h-2 rounded-full mr-2 ".concat(e.approvedByAdmin?"bg-green-600":"bg-yellow-600")}),e.approvedByAdmin?"Approved":"Pending"]})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,r.jsx)("div",{className:"flex space-x-2",children:e.approvedByAdmin?(0,r.jsxs)("span",{className:"inline-flex items-center px-3 py-1 text-xs font-medium rounded-full bg-green-100 text-green-800 border border-green-200",children:[(0,r.jsx)("div",{className:"w-2 h-2 rounded-full mr-2 bg-green-600"}),"Approved"]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("button",{onClick:()=>k(e._id),className:"inline-flex items-center px-4 py-2 text-xs font-medium rounded text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors",children:"Approve"}),(0,r.jsx)("button",{onClick:()=>v(e._id),className:"inline-flex items-center px-4 py-2 text-xs font-medium rounded text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 transition-colors",children:"Reject"})]})})})]},e._id)):(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:5,className:"px-6 py-4 text-center text-gray-500",children:"No brokers found in this region"})})})]})})})]})]})})}}]);